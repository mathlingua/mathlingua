{"version":3,"sources":["components/path-tree-item/PathTreeItem.module.css","support/util.ts","store/sidePanelVisibleSlice.ts","support/hooks.ts","components/side-panel-button/SidePanelButton.tsx","services/AutoComplete.ts","services/Search.ts","services/api.ts","store/pathsSlice.ts","store/querySlice.ts","components/search-panel/SearchPanel.tsx","components/github-icon/GitHubIcon.tsx","store/errorResultsSlice.ts","store/isEditModeSlice.ts","components/edit-mode-button/EditModeButton.tsx","components/topbar/TopBar.tsx","components/rendered-component/RenderedComponent.tsx","components/block-comment/BlockComment.tsx","components/error-view/ErrorView.tsx","components/entities-panel/EntitiesPanel.tsx","components/top-level-entry/TopLevelEntry.tsx","components/top-level-entity-group/TopLevelEntityGroup.tsx","components/page/Page.tsx","components/path-tree-item/PathTreeItem.tsx","components/side-panel/SidePanel.tsx","components/content-panel/ContentPanel.tsx","App.tsx","store/store.ts","support/serviceWorker.ts","index.tsx","components/search-panel/SearchPanel.module.css","components/page/Page.module.css","components/top-level-entry/TopLevelEntry.module.css","components/entities-panel/EntitiesPanel.module.css","components/top-level-entity-group/TopLevelEntityGroup.module.css","components/error-view/ErrorView.module.css","components/side-panel/SidePanel.module.css","App.module.css","components/topbar/TopBar.module.css","components/side-panel-button/SidePanelButton.module.css","components/github-icon/GitHubIcon.module.css","components/edit-mode-button/EditModeButton.module.css","components/block-comment/BlockComment.module.css"],"names":["module","exports","isOnMobile","window","screen","width","initialState","sidePanelVisible","sidePanelVisibleSlice","createSlice","name","reducers","sidePanelVisibilityChanged","state","action","payload","selectSidePanelVisible","actions","useAppDispatch","useDispatch","useAppSelector","useSelector","SidePanelButton","visible","dispatch","style","display","alignItems","padding","marginLeft","marginRight","marginTop","marginBottom","className","styles","sidePanelButton","onClick","icon","faBars","TrieNode","isWord","children","this","Map","AutoComplete","root","word","addToTrie","toLowerCase","prefix","searchTrie","trieNode","index","length","c","has","set","subNode","get","node","findTrieLeaf","result","Set","getWordsUnder","Array","from","buffer","char","add","keys","substring","Search","data","searchIndex","collectionResult","fileResults","fileResult","entities","entity","words","key","pathSet","relativePath","query","terms","split","map","it","trim","filter","size","i","intersect","set1","set2","values","x","notifyOfError","error","console","NetworkApiClient","a","axios","res","paths","message","path","params","undefined","suffixes","signature","errors","StaticApiClient","searchClient","autoCompleteClient","allPaths","signatureToEntity","pathToFileResult","firstFileResult","checkResponse","err","column","row","search","getSuffixes","client","getClient","MATHLINGUA_DATA","getAllPaths","getFileResult","getAutocompleteSuffixes","getEntityWithSignature","check","writeFileResult","content","put","deleteDir","post","deleteFile","renameDir","fromPath","toPath","renameFile","newDir","newFile","getSignatureSuffixes","pathsSlice","pathsUpdated","selectPaths","updatePathsForQuery","api","querySlice","queryUpdated","selectQuery","SearchPanel","ref","useRef","useState","setQuery","dropdownDisplayStyle","setDropdownDisplayStyle","suggestions","setSuggestions","selectedIndex","setSelectedIndex","getLastQueryWord","text","setDropDownVisible","event","target","value","lastWord","suffix","complete","appendSuggestionSuffix","completeQuery","e","preventDefault","selectedSuggestion","queryToUse","Math","min","max","useEffect","document","addEventListener","current","contains","searchArea","type","id","onChange","onKeyUp","searchButton","faSearch","clearButton","faTimes","searchDropdown","suggestion","searchDropdownItemSelected","searchDropdownItem","GitHubIcon","href","githubIcon","faGithub","errorResultsSlice","errorResultsUpdated","selectErrorResults","errorResults","isEditModeSlice","isEditMode","isEditModeUpdated","selectIsEditMode","EditModeButton","editModeButton","faEye","faEdit","TopBar","topbar","RenderedComponent","props","React","createRef","renderLatex","mathlinguaToggleDropdown","el","getElementById","viewSignature","entityResult","onViewEntity","fnName","fnArgs","rawId","rawSignature","replace","options","Element","attribs","onclick","exec","processInnerClick","domToReact","parse","html","uuid","Component","connect","buildMathFragment","rawText","fragment","createDocumentFragment","appendChild","createTextNode","span","createElement","math","katex","render","throwOnError","displayMode","indexOf","isInWritten","childNodes","n","textContent","child","nodeType","replaceChild","BlockComment","mathlinguaBlockCommentTopLevel","renderedHtml","ErrorView","errorMessage","errorLabel","EntitiesPanel","entitiesPanel","entityPanes","closeAllButton","onCloseAll","pane","entitiesPanelItem","topLevelEntry","TopLevelEntry","showRendered","setShowRendered","mathlinguaTopLevel","showCloseButton","mathlinguaCloseButton","onEntityClosed","mathlinguaIconPane","showOpenButton","to","mathlinguaOpenIcon","faShare","mathlinguaFlipIcon","rawHtml","TopLevelEntityGroup","entitiesWithIds","setEntitiesWithIds","concat","container","topLevelEntityGroup","triangleBorder","triangle","BASE_COMPLETIONS","scheduledFunction","Page","setFileResult","setError","isLoading","setIsLoading","viewedPath","then","mathlinguaPage","targetId","PageWithNavigationView","linkPanel","previousRelativePath","previousLink","faAngleLeft","nextRelativePath","nextLink","faAngleRight","RenderedContent","markInstance","Mark","unmark","done","mark","caseSensitive","separateWordSearch","scroll","top","left","behavior","scrollIntoView","errorView","errorItem","EditorView","memo","aceEditorRef","annotations","setAnnotations","langTools","getCompletions","editor","session","pos","callback","indent","remoteCompletions","item","editorRefVal","onFileResultChanged","setValue","clearSelection","getSession","saveContent","getValue","cancel","debounce","Promise","all","resp","mode","theme","editorProps","$blockScrolling","highlightActiveLine","showPrintMargin","enableBasicAutocompletion","enableLiveAutocompletion","fontSize","position","height","minHeight","SideBySideView","setRelativePath","setErrors","setEntities","flexDirection","maxHeight","overflow","borderLeft","borderLeftWidth","borderLeftColor","background","PathTreeItem","isDir","isExpanded","setIsExpanded","allErrorResults","inputName","setInputName","isEditing","setIsEditing","isDeleting","setIsDeleting","reloadAllPaths","getAllErrorsFor","allErrors","getErrorStats","thisErrorResults","title","errorStats","isNaN","updateInputName","endsWith","alert","newPathParts","pop","push","newPath","join","onSubmit","getEditButtons","button","faPencilAlt","faFileMedical","faFolderPlus","faCheck","faTrashAlt","sidePanelItem","maxWidth","mathlinguaListDirItem","faCaretDown","faCaretRight","input","placeholder","mathlinguaListFileItem","link","selected","SidePanel","setAllPaths","pathData","setPathData","catch","populateTreeNode","allPathsToTreeNode","sidePanel","start","parts","cur","p","find","newChild","slice","ContentPanel","location","hashLocation","useLocation","pathname","hash","isSidePanelVisible","isMobile","ThreeColumnContent","margin","TwoColumnContent","border","borderColor","borderWidth","App","hashType","contentPanel","ErrorBoundary","hasError","info","setState","store","configureStore","reducer","sidePanelVisibleReducer","pathsReducer","queryReducer","isEditModeReducer","errorResultsReducer","middleware","thunkMiddleware","Boolean","hostname","match","ReactDOM","StrictMode","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.948f0a7c.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"triangle\":\"PathTreeItem_triangle__1r7e7\",\"link\":\"PathTreeItem_link__2zHfD\",\"sidePanelItem\":\"PathTreeItem_sidePanelItem__1A12M\",\"mathlinguaListDirItem\":\"PathTreeItem_mathlinguaListDirItem__3BEwG\",\"mathlinguaListFileItem\":\"PathTreeItem_mathlinguaListFileItem__1JNHt\",\"selected\":\"PathTreeItem_selected__r_5l2\",\"errorStats\":\"PathTreeItem_errorStats__1EFpQ\",\"button\":\"PathTreeItem_button__1hcH-\",\"input\":\"PathTreeItem_input__1EXXq\"};","export function isOnMobile() {\n  return window.screen.width <= 500;\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from './store';\nimport { isOnMobile } from '../support/util';\n\nexport interface SidePanelVisibleState {\n  sidePanelVisible: boolean;\n}\n\nconst initialState: SidePanelVisibleState = {\n  sidePanelVisible: !isOnMobile(),\n};\n\nconst sidePanelVisibleSlice = createSlice({\n  name: 'sidePanelVisible',\n  initialState,\n  reducers: {\n    sidePanelVisibilityChanged(\n      state: SidePanelVisibleState,\n      action: PayloadAction<boolean>\n    ) {\n      state.sidePanelVisible = action.payload;\n    },\n  },\n});\n\nexport const selectSidePanelVisible = (state: RootState) =>\n  state.sidePanelVisible.sidePanelVisible;\n\nexport const { sidePanelVisibilityChanged } = sidePanelVisibleSlice.actions;\n\nexport default sidePanelVisibleSlice.reducer;\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport type { RootState, AppDispatch } from '../store/store';\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import styles from './SidePanelButton.module.css';\n\nimport {\n  selectSidePanelVisible,\n  sidePanelVisibilityChanged,\n} from '../../store/sidePanelVisibleSlice';\nimport { useAppDispatch, useAppSelector } from '../../support/hooks';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBars } from '@fortawesome/free-solid-svg-icons';\n\nexport const SidePanelButton = () => {\n  const visible = useAppSelector(selectSidePanelVisible);\n  const dispatch = useAppDispatch();\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        padding: 0,\n        marginLeft: 0,\n        marginRight: 0,\n        marginTop: 0,\n        marginBottom: 'auto',\n      }}\n    >\n      <button\n        className={styles.sidePanelButton}\n        onClick={() => {\n          dispatch(sidePanelVisibilityChanged(!visible));\n        }}\n      >\n        <FontAwesomeIcon icon={faBars} />\n      </button>\n    </div>\n  );\n};\n","class TrieNode {\n  isWord: boolean;\n  readonly children: Map<string, TrieNode>;\n\n  constructor(isWord: boolean) {\n    this.isWord = isWord;\n    this.children = new Map();\n  }\n}\n\nexport class AutoComplete {\n  private root = new TrieNode(false);\n\n  add(word: string) {\n    this.addToTrie(this.root, word.toLowerCase(), 0);\n  }\n\n  getSuffixes(prefix: string) {\n    return this.searchTrie(this.root, prefix.toLowerCase());\n  }\n\n  private addToTrie(trieNode: TrieNode, word: string, index: number) {\n    if (index >= word.length) {\n      return;\n    }\n\n    const c = word[index];\n    if (!trieNode.children.has(c)) {\n      trieNode.children.set(c, {\n        isWord: index === word.length - 1,\n        children: new Map(),\n      });\n    }\n\n    const subNode = trieNode.children.get(c)!;\n    if (index === word.length - 1) {\n      subNode.isWord = true;\n    }\n\n    this.addToTrie(subNode, word, index + 1);\n  }\n\n  private searchTrie(trieNode: TrieNode, word: string) {\n    const node = this.findTrieLeaf(trieNode, word, 0);\n    if (!node) {\n      return [];\n    }\n    const result = new Set<string>();\n    this.getWordsUnder('', '', node, result);\n    return Array.from(result);\n  }\n\n  private findTrieLeaf(\n    trieNode: TrieNode,\n    word: string,\n    index: number\n  ): TrieNode | null {\n    if (index >= word.length) {\n      return trieNode;\n    }\n\n    const c = word[index];\n    if (trieNode.children.has(c)) {\n      return this.findTrieLeaf(trieNode.children.get(c)!, word, index + 1);\n    }\n\n    return null;\n  }\n\n  private getWordsUnder(\n    buffer: string,\n    char: string,\n    trieNode: TrieNode,\n    result: Set<string>\n  ) {\n    if (!trieNode) {\n      return;\n    }\n\n    buffer += char;\n    if (trieNode.isWord) {\n      result.add(buffer);\n    }\n\n    for (const c of trieNode.children.keys() as any) {\n      this.getWordsUnder(buffer, c, trieNode.children.get(c)!, result);\n    }\n\n    buffer = buffer.substring(0, buffer.length - 1);\n  }\n}\n","import { DecompositionResult } from './api';\n\nexport class Search {\n  //                       word  -> set of paths\n  private searchIndex: Map<string, Set<string>> = new Map();\n\n  constructor(data: DecompositionResult) {\n    for (const fileResult of data.collectionResult.fileResults) {\n      for (const entity of fileResult.entities) {\n        for (const word of entity.words) {\n          const key = word.toLowerCase();\n          const pathSet = this.searchIndex.get(key) ?? new Set();\n          pathSet.add(fileResult.relativePath);\n          this.searchIndex.set(key, pathSet);\n        }\n      }\n    }\n  }\n\n  search(query: string): string[] {\n    const terms = query\n      .split(' ')\n      .map((it) => it.trim().toLowerCase())\n      .filter((it) => it.length > 0);\n    if (terms.length === 0) {\n      return [];\n    }\n\n    let result = this.searchIndex.get(terms[0]) ?? new Set();\n    if (result.size === 0) {\n      return [];\n    }\n\n    for (let i = 1; i < terms.length; i++) {\n      result = intersect(result, this.searchIndex.get(terms[i]) ?? new Set());\n    }\n\n    return Array.from(result);\n  }\n}\n\nfunction intersect(set1: Set<string>, set2: Set<string>): Set<string> {\n  if (set2.size > set1.size) {\n    return intersect(set2, set1);\n  }\n\n  const result: Set<string> = new Set();\n  for (const x of Array.from(set1.values())) {\n    if (set2.has(x)) {\n      result.add(x);\n    }\n  }\n  return result;\n}\n","import axios from 'axios';\nimport { AutoComplete } from './AutoComplete';\nimport { Search } from './Search';\n\nexport interface EntityResult {\n  id: string;\n  relativePath: string;\n  type: string;\n  signature: string;\n  rawHtml: string;\n  renderedHtml: string;\n  words: string[];\n}\n\nexport interface FileResult {\n  relativePath: string;\n  nextRelativePath?: string;\n  previousRelativePath?: string;\n  content: string;\n  entities: EntityResult[];\n  errors: ErrorResult[];\n}\n\nexport interface ErrorResult {\n  relativePath: string;\n  message: string;\n  row: number;\n  column: number;\n}\n\nexport interface CollectionResult {\n  fileResults: FileResult[];\n  errors: ErrorResult[];\n}\n\nexport interface DecompositionResult {\n  homeHtml: string;\n  collectionResult: CollectionResult;\n}\n\nexport interface CheckResponse {\n  errors: CheckError[];\n}\n\nexport interface CheckError {\n  path: string;\n  message: string;\n  row: number;\n  column: number;\n}\n\ninterface ApiClient {\n  getAllPaths(): Promise<string[]>;\n  getFileResult(path: string): Promise<FileResult | undefined>;\n  search(query: string): Promise<string[]>;\n  getAutocompleteSuffixes(word: string): Promise<string[]>;\n  getEntityWithSignature(signature: string): Promise<EntityResult | undefined>;\n  check(): Promise<CheckResponse>;\n}\n\nfunction notifyOfError(error: string) {\n  console.error(error);\n}\n\nclass NetworkApiClient implements ApiClient {\n  async getAllPaths(): Promise<string[]> {\n    try {\n      const res = await axios.get('/api/allPaths');\n      return res.data.paths;\n    } catch (error: any) {\n      notifyOfError(error.message);\n      return [];\n    }\n  }\n\n  async getFileResult(path: string): Promise<FileResult | undefined> {\n    try {\n      const res = await axios.get('/api/fileResult', {\n        params: { path },\n      });\n      return res.data;\n    } catch (error: any) {\n      notifyOfError(error.message);\n      return undefined;\n    }\n  }\n\n  async search(query: string): Promise<string[]> {\n    try {\n      const res = await axios.get('/api/search', { params: { query } });\n      return res.data.paths;\n    } catch (error: any) {\n      notifyOfError(error.message);\n      return [];\n    }\n  }\n\n  async getAutocompleteSuffixes(word: string): Promise<string[]> {\n    try {\n      const res = await axios.get('/api/completeWord', { params: { word } });\n      return res.data.suffixes;\n    } catch (error: any) {\n      notifyOfError(error.message);\n      return [];\n    }\n  }\n\n  async getEntityWithSignature(\n    signature: string\n  ): Promise<EntityResult | undefined> {\n    try {\n      const res = await axios.get('/api/withSignature', {\n        params: { signature },\n      });\n      return res.data;\n    } catch (error: any) {\n      notifyOfError(error.message);\n      return undefined;\n    }\n  }\n\n  async check(): Promise<CheckResponse> {\n    try {\n      const res = await axios.get('/api/check');\n      return res.data;\n    } catch (error: any) {\n      notifyOfError(error.message);\n      return { errors: [] };\n    }\n  }\n}\n\nclass StaticApiClient implements ApiClient {\n  private searchClient: Search;\n  private autoCompleteClient: AutoComplete;\n  private allPaths: string[];\n  private signatureToEntity: Map<string, EntityResult>;\n  private pathToFileResult: Map<string, FileResult>;\n  private firstFileResult: FileResult | undefined;\n  private checkResponse: CheckResponse;\n\n  constructor(data: DecompositionResult) {\n    this.searchClient = new Search(data);\n    this.autoCompleteClient = new AutoComplete();\n    for (const fileResult of data.collectionResult.fileResults) {\n      for (const entity of fileResult.entities) {\n        for (const word of entity.words) {\n          this.autoCompleteClient.add(word);\n        }\n      }\n    }\n\n    this.allPaths = data.collectionResult.fileResults.map(\n      (fileResult) => fileResult.relativePath\n    );\n\n    this.signatureToEntity = new Map();\n    for (const fileResult of data.collectionResult.fileResults) {\n      for (const entity of fileResult.entities) {\n        this.signatureToEntity.set(entity.signature, entity);\n      }\n    }\n\n    this.firstFileResult = data.collectionResult.fileResults[0];\n\n    this.pathToFileResult = new Map();\n    for (const fileResult of data.collectionResult.fileResults) {\n      this.pathToFileResult.set(fileResult.relativePath, fileResult);\n    }\n\n    this.checkResponse = {\n      errors: data.collectionResult.errors.map((err) => ({\n        column: err.column,\n        row: err.row,\n        path: err.relativePath,\n        message: err.message,\n      })),\n    };\n  }\n\n  async getAllPaths(): Promise<string[]> {\n    return this.allPaths;\n  }\n\n  async getFileResult(path: string): Promise<FileResult | undefined> {\n    if (path === '') {\n      return this.firstFileResult;\n    }\n\n    return this.pathToFileResult.get(path);\n  }\n\n  async search(query: string): Promise<string[]> {\n    return this.searchClient.search(query);\n  }\n\n  async getAutocompleteSuffixes(word: string): Promise<string[]> {\n    return this.autoCompleteClient.getSuffixes(word);\n  }\n\n  async getEntityWithSignature(\n    signature: string\n  ): Promise<EntityResult | undefined> {\n    return this.signatureToEntity.get(signature);\n  }\n\n  async check(): Promise<CheckResponse> {\n    return this.checkResponse;\n  }\n}\n\nlet client: ApiClient | null = null;\nfunction getClient(): ApiClient {\n  if (!client) {\n    const data = (window as any).MATHLINGUA_DATA;\n    if (data) {\n      client = new StaticApiClient(data);\n    } else {\n      client = new NetworkApiClient();\n    }\n  }\n  return client;\n}\n\nexport function isStatic() {\n  return !!(window as any).MATHLINGUA_DATA;\n}\n\nexport async function getAllPaths(): Promise<string[]> {\n  return getClient().getAllPaths();\n}\n\nexport async function getFileResult(\n  path: string\n): Promise<FileResult | undefined> {\n  return getClient().getFileResult(path);\n}\n\nexport async function search(query: string): Promise<string[]> {\n  return getClient().search(query);\n}\n\nexport async function getAutocompleteSuffixes(word: string): Promise<string[]> {\n  return getClient().getAutocompleteSuffixes(word);\n}\n\nexport async function getEntityWithSignature(\n  signature: string\n): Promise<EntityResult | undefined> {\n  return getClient().getEntityWithSignature(signature);\n}\n\nexport async function check(): Promise<CheckResponse> {\n  return getClient().check();\n}\n\nexport async function writeFileResult(path: string, content: string) {\n  try {\n    await axios.put('/api/writePage', {\n      path,\n      content,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n  }\n}\n\nexport async function readPage(path: string): Promise<string> {\n  try {\n    const result = await axios.get('/api/readPage', {\n      params: { path },\n    });\n    return result.data.content;\n  } catch (error: any) {\n    notifyOfError(error.message);\n    return '';\n  }\n}\n\nexport async function deleteDir(path: string): Promise<void> {\n  try {\n    await axios.post('/api/deleteDir', {\n      path,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n  }\n}\n\nexport async function deleteFile(path: string): Promise<void> {\n  try {\n    await axios.post('/api/deleteFile', {\n      path,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n  }\n}\n\nexport async function renameDir(\n  fromPath: string,\n  toPath: string\n): Promise<void> {\n  try {\n    await axios.post('/api/renameDir', {\n      fromPath,\n      toPath,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n    return;\n  }\n}\n\nexport async function renameFile(\n  fromPath: string,\n  toPath: string\n): Promise<void> {\n  try {\n    await axios.post('/api/renameFile', {\n      fromPath,\n      toPath,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n  }\n}\n\nexport async function newDir(path: string): Promise<void> {\n  try {\n    await axios.post('/api/newDir', {\n      path,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n  }\n}\n\nexport async function newFile(path: string): Promise<void> {\n  try {\n    await axios.post('/api/newFile', {\n      path,\n    });\n  } catch (error: any) {\n    notifyOfError(error.message);\n  }\n}\n\nexport async function getSignatureSuffixes(prefix: string): Promise<string[]> {\n  try {\n    const res = await axios.get('/api/completeSignature', {\n      params: { prefix },\n    });\n    return res.data.suffixes;\n  } catch (error: any) {\n    notifyOfError(error.message);\n    return [];\n  }\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { AppThunk, RootState } from './store';\nimport * as api from '../services/api';\n\nexport interface PathsState {\n  paths: string[] | undefined;\n}\n\nconst initialState: PathsState = {\n  paths: [],\n};\n\nconst pathsSlice = createSlice({\n  name: 'paths',\n  initialState,\n  reducers: {\n    pathsUpdated(\n      state: PathsState,\n      action: PayloadAction<string[] | undefined>\n    ) {\n      if (!action.payload) {\n        state.paths = action.payload;\n      } else {\n        state.paths = [...action.payload];\n      }\n    },\n  },\n});\n\nexport const selectPaths = (state: RootState) => state.paths.paths;\n\nexport const { pathsUpdated } = pathsSlice.actions;\n\nexport const updatePathsForQuery =\n  (query: string): AppThunk =>\n  async (dispatch) => {\n    const paths = await api.search(query);\n    dispatch(pathsUpdated(paths));\n  };\n\nexport default pathsSlice.reducer;\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from './store';\n\nexport interface QueryState {\n  query: string;\n}\n\nconst initialState: QueryState = {\n  query: '',\n};\n\nconst querySlice = createSlice({\n  name: 'query',\n  initialState,\n  reducers: {\n    queryUpdated(state: QueryState, action: PayloadAction<string>) {\n      state.query = action.payload;\n    },\n  },\n});\n\nexport const selectQuery = (state: RootState) => state.query.query;\n\nexport const { queryUpdated } = querySlice.actions;\n\nexport default querySlice.reducer;\n","import { useEffect, useRef, useState } from 'react';\nimport styles from './SearchPanel.module.css';\n\nimport * as api from '../../services/api';\n\nimport { pathsUpdated, updatePathsForQuery } from '../../store/pathsSlice';\nimport { useDispatch } from 'react-redux';\nimport { queryUpdated } from '../../store/querySlice';\nimport { sidePanelVisibilityChanged } from '../../store/sidePanelVisibleSlice';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch, faTimes } from '@fortawesome/free-solid-svg-icons';\n\ninterface Suggestion {\n  complete: string;\n  suffix: string;\n}\n\nexport const SearchPanel = () => {\n  const dispatch = useDispatch();\n  const ref = useRef(null);\n  const [query, setQuery] = useState('');\n  const [dropdownDisplayStyle, setDropdownDisplayStyle] = useState('none');\n  const [suggestions, setSuggestions] = useState([] as Suggestion[]);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n\n  function getLastQueryWord(text: string): string {\n    if (!text) {\n      return text;\n    }\n    const words = text.split(' ').filter((it: string) => it.length > 0);\n    return words[words.length - 1];\n  }\n\n  function setDropDownVisible(visible: boolean) {\n    setDropdownDisplayStyle(visible ? 'block' : 'none');\n  }\n\n  async function handleChange(event: any) {\n    const text = event.target.value || '';\n    const lastWord = getLastQueryWord(text);\n    try {\n      const suffixes = await api.getAutocompleteSuffixes(lastWord);\n      setSuggestions(\n        suffixes.map((suffix) => ({\n          complete: lastWord + suffix,\n          suffix,\n        }))\n      );\n    } catch (err: any) {\n      const message = `ERROR: ${err.message}`;\n      setSuggestions([\n        {\n          complete: message,\n          suffix: message,\n        },\n      ]);\n    }\n    setDropDownVisible(true);\n    setQuery(text);\n  }\n\n  async function search(query: string) {\n    dispatch(updatePathsForQuery(query));\n    setDropDownVisible(false);\n    dispatch(queryUpdated(query));\n    dispatch(sidePanelVisibilityChanged(true));\n  }\n\n  function clearSearch() {\n    setQuery('');\n    setDropDownVisible(false);\n    dispatch(pathsUpdated(undefined));\n    dispatch(queryUpdated(''));\n    dispatch(sidePanelVisibilityChanged(true));\n  }\n\n  function appendSuggestionSuffix(suffix: string) {\n    const completeQuery = query.toLowerCase() + suffix.toLowerCase();\n    setQuery(completeQuery);\n    setDropDownVisible(false);\n    return completeQuery;\n  }\n\n  useEffect(() => {\n    document.addEventListener('click', (event) => {\n      if (ref.current && !(ref.current as any).contains(event.target)) {\n        setDropDownVisible(false);\n      }\n    });\n  }, []);\n\n  async function onKeyUp(e: any) {\n    if (e.key === 'Escape') {\n      setDropDownVisible(false);\n      return;\n    } else if (e.key === 'Enter') {\n      e.preventDefault();\n      if (dropdownDisplayStyle !== 'none') {\n        const selectedSuggestion = suggestions[selectedIndex];\n        let queryToUse = query;\n        if (selectedSuggestion) {\n          queryToUse = appendSuggestionSuffix(selectedSuggestion.suffix);\n        }\n        await search(queryToUse);\n      } else {\n        await search(query);\n      }\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault();\n      setDropDownVisible(true);\n      setSelectedIndex(Math.min(selectedIndex + 1, suggestions.length - 1));\n      return;\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault();\n      setDropDownVisible(true);\n      setSelectedIndex(Math.max(selectedIndex - 1, 0));\n      return;\n    }\n  }\n\n  return (\n    <span className={styles.searchArea}>\n      <input\n        type=\"text\"\n        id=\"search-input\"\n        className={styles.search}\n        aria-label=\"search\"\n        value={query}\n        onChange={handleChange}\n        onKeyUp={onKeyUp}\n      />\n      <button\n        type=\"button\"\n        className={styles.searchButton}\n        onClick={() => search(query)}\n      >\n        <FontAwesomeIcon icon={faSearch} />\n      </button>\n      <button\n        type=\"button\"\n        className={styles.clearButton}\n        onClick={clearSearch}\n      >\n        <FontAwesomeIcon icon={faTimes} />\n      </button>\n      <div\n        ref={ref}\n        className={styles.searchDropdown}\n        style={{ display: dropdownDisplayStyle }}\n      >\n        {suggestions.map((suggestion, index) => (\n          <div\n            key={suggestion.complete.toLowerCase()}\n            onClick={() => {\n              const newQuery = appendSuggestionSuffix(suggestion.suffix);\n              return search(newQuery);\n            }}\n            className={\n              index === selectedIndex\n                ? styles.searchDropdownItemSelected\n                : styles.searchDropdownItem\n            }\n          >\n            <div>{suggestion.complete.toLowerCase()}</div>\n          </div>\n        ))}\n      </div>\n    </span>\n  );\n};\n","import styles from './GitHubIcon.module.css';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faGithub } from '@fortawesome/free-brands-svg-icons';\n\nexport const GitHubIcon = () => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        padding: 0,\n        marginLeft: 0,\n        marginRight: 0,\n        marginTop: 0,\n        marginBottom: 'auto',\n      }}\n    >\n      <a href=\"https://github.com/DominicKramer/codex\">\n        <FontAwesomeIcon className={styles.githubIcon} icon={faGithub} />\n      </a>\n    </div>\n  );\n};\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from './store';\nimport * as api from '../services/api';\n\nexport interface ErrorResultsState {\n  errors: api.ErrorResult[];\n}\n\nconst initialState: ErrorResultsState = {\n  errors: [],\n};\n\nconst errorResultsSlice = createSlice({\n  name: 'errorResults',\n  initialState,\n  reducers: {\n    errorResultsUpdated(\n      state: ErrorResultsState,\n      action: PayloadAction<api.ErrorResult[]>\n    ) {\n      state.errors = action.payload;\n    },\n  },\n});\n\nexport const selectErrorResults = (state: RootState) =>\n  state.errorResults.errors;\n\nexport const { errorResultsUpdated } = errorResultsSlice.actions;\n\nexport default errorResultsSlice.reducer;\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState } from './store';\n\nexport interface IsEditModeState {\n  isEditMode: boolean;\n}\n\nconst initialState: IsEditModeState = {\n  isEditMode: false,\n};\n\nconst isEditModeSlice = createSlice({\n  name: 'isEditMode',\n  initialState,\n  reducers: {\n    isEditModeUpdated(state: IsEditModeState, action: PayloadAction<boolean>) {\n      state.isEditMode = action.payload;\n    },\n  },\n});\n\nexport const selectIsEditMode = (state: RootState) =>\n  state.isEditMode.isEditMode;\n\nexport const { isEditModeUpdated } = isEditModeSlice.actions;\n\nexport default isEditModeSlice.reducer;\n","import { check } from '../../services/api';\nimport { errorResultsUpdated } from '../../store/errorResultsSlice';\nimport {\n  isEditModeUpdated,\n  selectIsEditMode,\n} from '../../store/isEditModeSlice';\nimport { useAppDispatch, useAppSelector } from '../../support/hooks';\nimport styles from './EditModeButton.module.css';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEdit, faEye } from '@fortawesome/free-solid-svg-icons';\n\nexport const EditModeButton = () => {\n  const dispatch = useAppDispatch();\n  const isEditMode = useAppSelector(selectIsEditMode);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        padding: 0,\n        marginLeft: 0,\n        marginRight: 0,\n        marginTop: 0,\n        marginBottom: 'auto',\n      }}\n    >\n      <button\n        className={styles.editModeButton}\n        onClick={async () => {\n          dispatch(isEditModeUpdated(!isEditMode));\n          const res = await check();\n          dispatch(\n            errorResultsUpdated(\n              res.errors.map((err) => ({\n                row: err.row,\n                column: err.column,\n                message: err.message,\n                relativePath: err.path,\n              }))\n            )\n          );\n        }}\n      >\n        {isEditMode ? (\n          <FontAwesomeIcon icon={faEye} />\n        ) : (\n          <FontAwesomeIcon icon={faEdit} />\n        )}\n      </button>\n    </div>\n  );\n};\n","import styles from './TopBar.module.css';\n\nimport { SidePanelButton } from '../side-panel-button/SidePanelButton';\nimport { SearchPanel } from '../search-panel/SearchPanel';\nimport { GitHubIcon } from '../github-icon/GitHubIcon';\nimport { isStatic } from '../../services/api';\nimport { EditModeButton } from '../edit-mode-button/EditModeButton';\n\nexport const TopBar = () => {\n  return (\n    <div className={styles.topbar}>\n      <SidePanelButton />\n      <SearchPanel />\n      {isStatic() ? null : <EditModeButton />}\n      <GitHubIcon />\n    </div>\n  );\n};\n","import parse, { DOMNode, domToReact } from 'html-react-parser';\nimport { Element } from 'domhandler/lib/node';\n\nimport React from 'react';\nimport './RenderedComponent.css';\nimport * as api from '../../services/api';\nimport { connect } from 'react-redux';\nimport * as uuid from 'uuid';\n\ndeclare const katex: any;\n\nexport interface RenderedComponentProps {\n  html: string;\n  onViewEntity?: (entity: api.EntityResult) => void;\n}\n\nclass RenderedComponent extends React.Component<RenderedComponentProps> {\n  private ref: any;\n\n  constructor(props: RenderedComponentProps) {\n    super(props);\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    renderLatex(this.ref.current);\n  }\n\n  componentDidUpdate() {\n    renderLatex(this.ref.current);\n  }\n\n  render() {\n    const mathlinguaToggleDropdown = (id: string) => {\n      const el = document.getElementById(id);\n      if (el) {\n        if (el.className === 'mathlingua-dropdown-menu-hidden') {\n          el.className = 'mathlingua-dropdown-menu-shown';\n        } else {\n          el.className = 'mathlingua-dropdown-menu-hidden';\n        }\n      }\n    };\n\n    const viewSignature = async (signature: string, id: string) => {\n      mathlinguaToggleDropdown(id);\n      const entityResult = await api.getEntityWithSignature(signature);\n      if (entityResult && this.props.onViewEntity) {\n        this.props.onViewEntity(entityResult);\n      }\n    };\n\n    async function processInnerClick(fnName: string, fnArgs: string[]) {\n      if (fnName === 'mathlinguaToggleDropdown') {\n        const rawId = fnArgs[0];\n        if (!rawId) {\n          return;\n        }\n        // the raw id is enclosed in either single or double quotes\n        const id = rawId.substring(1, rawId.length - 1);\n        mathlinguaToggleDropdown(id);\n      } else if (fnName === 'mathlinguaViewSignature') {\n        const rawSignature = fnArgs[0];\n        const rawId = fnArgs[1];\n        if (!rawSignature || !rawId) {\n          return;\n        }\n        // the javascript code has the backslashes escaped\n        // thus they need to be un-escaped to get the actual signature\n        const signature = rawSignature\n          .substring(1, rawSignature.length - 1)\n          .replace(/\\\\\\\\/, '\\\\');\n        const id = rawId.substring(1, rawId.length - 1);\n        viewSignature(signature, id);\n      }\n    }\n\n    const options = {\n      replace: (node: DOMNode) => {\n        if (\n          !(node instanceof Element) ||\n          !node.attribs ||\n          !node.attribs.onclick\n        ) {\n          return;\n        }\n\n        const onclick = node.attribs.onclick;\n        delete node.attribs.onclick;\n\n        const className = node.attribs['class'];\n        delete node.attribs['class'];\n\n        const exec = /([a-zA-Z0-9]+)\\((.*?)\\)/.exec(onclick.trim());\n        if (exec && exec.length === 3) {\n          const fnName = exec[1];\n          const fnArgs = exec[2].split(',').map((it) => it.trim());\n          return (\n            <span\n              className={className}\n              onClick={() => processInnerClick(fnName, fnArgs)}\n            >\n              {domToReact(node.children, options)}\n            </span>\n          );\n        }\n      },\n    };\n    return (\n      <div ref={this.ref}>\n        {parse(this.props.html.replace(/CUSTOM_SUFFIX/g, uuid.v4()), options)}\n      </div>\n    );\n  }\n}\n\nexport default connect()(RenderedComponent);\n\nfunction buildMathFragment(rawText: string) {\n  let text = rawText;\n  if (text[0] === '\"') {\n    text = text.substring(1);\n  }\n  if (text[text.length - 1] === '\"') {\n    text = text.substring(0, text.length - 1);\n  }\n  text = text.replace(/([a-zA-Z0-9])\\?\\??/g, '$1');\n  const fragment = document.createDocumentFragment();\n  let buffer = '';\n  let i = 0;\n  while (i < text.length) {\n    if (text[i] === '$' && text[i + 1] === '$' && text[i + 2] === '$') {\n      i += 3; // skip over the $s\n      fragment.appendChild(document.createTextNode(buffer));\n      buffer = '';\n\n      const span = document.createElement('span');\n      let math = '';\n      while (\n        i < text.length &&\n        !(text[i] === '$' && text[i + 1] === '$' && text[i + 2] === '$')\n      ) {\n        math += text[i++];\n      }\n      if (text[i] === '$') {\n        i++; // move past the $\n      }\n      if (text[i] === '$') {\n        i++; // move past the second $\n      }\n      if (text[i] === '$') {\n        i++; // move past the third $\n      }\n      try {\n        katex.render(math, span, {\n          throwOnError: true,\n          displayMode: false,\n        });\n      } catch (e) {\n        span.appendChild(document.createTextNode(math));\n      }\n      fragment.appendChild(span);\n    } else if (text[i] === '\\\\' && text[i + 1] === '[') {\n      i += 2; // skip over \\ and [\n      fragment.appendChild(document.createTextNode(buffer));\n      buffer = '';\n\n      const span = document.createElement('span');\n      span.className = 'display-mode';\n      let math = '';\n      while (i < text.length && !(text[i] === '\\\\' && text[i + 1] === ']')) {\n        math += text[i++];\n      }\n      if (text[i] === '\\\\') {\n        i++; // move past the \\\n      }\n      if (text[i] === ']') {\n        i++; // move past the ]\n      }\n      try {\n        katex.render(math, span, {\n          throwOnError: true,\n          displayMode: true,\n        });\n      } catch {\n        span.appendChild(document.createTextNode(math));\n      }\n      fragment.appendChild(span);\n    } else if (text[i] === '\\\\' && text[i + 1] === '(') {\n      i += 2; // skip over \\ and ()\n      fragment.appendChild(document.createTextNode(buffer));\n      buffer = '';\n\n      const span = document.createElement('span');\n      let math = '';\n      while (i < text.length && !(text[i] === '\\\\' && text[i + 1] === ')')) {\n        math += text[i++];\n      }\n      if (text[i] === '\\\\') {\n        i++; // move past the \\\n      }\n      if (text[i] === ')') {\n        i++; // move past the )\n      }\n      try {\n        katex.render(math, span, {\n          throwOnError: true,\n          displayMode: false,\n        });\n      } catch {\n        span.appendChild(document.createTextNode(math));\n      }\n      fragment.appendChild(span);\n    } else if (text[i] === '$' && text[i + 1] === '$') {\n      i += 2; // skip over $ and $\n      fragment.appendChild(document.createTextNode(buffer));\n      buffer = '';\n\n      const span = document.createElement('span');\n      span.className = 'display-mode';\n      let math = '';\n      while (i < text.length && !(text[i] === '$' && text[i + 1] === '$')) {\n        math += text[i++];\n      }\n      if (text[i] === '$') {\n        i++; // move past the $\n      }\n      if (text[i] === '$') {\n        i++; // move past the $\n      }\n      try {\n        katex.render(math, span, {\n          throwOnError: true,\n          displayMode: true,\n        });\n      } catch {\n        span.appendChild(document.createTextNode(math));\n      }\n      fragment.appendChild(span);\n    } else if (text[i] === '$') {\n      i++; // skip over the $\n      fragment.appendChild(document.createTextNode(buffer));\n      buffer = '';\n\n      const span = document.createElement('span');\n      let math = '';\n      while (i < text.length && text[i] !== '$') {\n        math += text[i++];\n      }\n      if (text[i] === '$') {\n        i++; // move past the $\n      }\n      try {\n        katex.render(math, span, {\n          throwOnError: true,\n          displayMode: false,\n        });\n      } catch {\n        span.appendChild(document.createTextNode(math));\n      }\n      fragment.appendChild(span);\n    } else {\n      buffer += text[i++];\n    }\n  }\n\n  if (buffer.length > 0) {\n    fragment.appendChild(document.createTextNode(buffer));\n  }\n\n  return fragment;\n}\n\nfunction renderLatex(node: any) {\n  if (\n    node.className &&\n    node.className.indexOf &&\n    node.className.indexOf('no-render') >= 0\n  ) {\n    return;\n  }\n\n  let isInWritten = false;\n  if (node.className === 'mathlingua') {\n    for (let i = 0; i < node.childNodes.length; i++) {\n      const n = node.childNodes[i];\n      if (\n        n &&\n        n.className === 'mathlingua-header' &&\n        n.textContent === 'written:'\n      ) {\n        isInWritten = true;\n        break;\n      }\n    }\n  }\n\n  for (let i = 0; i < node.childNodes.length; i++) {\n    const child = node.childNodes[i];\n\n    // node is an element node => nodeType === 1\n    // node is an attribute node => nodeType === 2\n    // node is a text node => nodeType === 3\n    // node is a comment node => nodeType === 8\n    if (child.nodeType === 3) {\n      let text = child.textContent;\n      if (text.trim()) {\n        if (isInWritten) {\n          // if the text is in a written: section\n          // turn \"some text\" to $$$some text$$$\n          // so the text is in math mode\n          if (text[0] === '\"') {\n            text = text.substring(1);\n          }\n          if (text[text.length - 1] === '\"') {\n            text = text.substring(0, text.length - 1);\n          }\n          text = '$$$' + text + '$$$';\n        }\n        const fragment = buildMathFragment(text);\n        i += fragment.childNodes.length - 1;\n        node.replaceChild(fragment, child);\n      }\n    } else if (child.nodeType === 1) {\n      renderLatex(child);\n    }\n  }\n}\n","import RenderedComponent from '../rendered-component/RenderedComponent';\nimport styles from './BlockComment.module.css';\n\nexport interface BlockCommentProps {\n  rawHtml: string;\n  renderedHtml: string;\n}\n\nexport const BlockComment = (props: BlockCommentProps) => {\n  return (\n    <div className={styles.mathlinguaBlockCommentTopLevel}>\n      <RenderedComponent html={props.renderedHtml}></RenderedComponent>\n    </div>\n  );\n};\n","import styles from './ErrorView.module.css';\n\ninterface ErrorViewProps {\n  message: string;\n}\n\nexport function ErrorView(props: ErrorViewProps) {\n  return (\n    <div className={styles.errorMessage}>\n      <span className={styles.errorLabel}>ERROR:</span> {props.message}\n    </div>\n  );\n}\n","import styles from './EntitiesPanel.module.css';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTimes } from '@fortawesome/free-solid-svg-icons';\n\nexport interface EntryPane {\n  id: string;\n  // the JSX.Element that is a <TopLevelEntry/>\n  topLevelEntry: JSX.Element;\n}\n\nexport interface EntitiesPanelProps {\n  entityPanes: EntryPane[];\n  onCloseAll?: () => void;\n}\n\nexport const EntitiesPanel = (props: EntitiesPanelProps) => {\n  return (\n    <div\n      className={styles.entitiesPanel}\n      style={\n        props.entityPanes.length > 0\n          ? { display: 'block' }\n          : { display: 'none' }\n      }\n    >\n      <div>\n        <button\n          className={styles.closeAllButton}\n          onClick={() => {\n            if (props.onCloseAll) {\n              props.onCloseAll();\n            }\n          }}\n          data-test-id=\"close-all-entities\"\n        >\n          <FontAwesomeIcon icon={faTimes} />\n        </button>\n        {props.entityPanes.map((pane) => (\n          <span key={pane.id} className={styles.entitiesPanelItem}>\n            {pane.topLevelEntry}\n          </span>\n        ))}\n      </div>\n    </div>\n  );\n};\n","import { useState } from 'react';\nimport RenderedComponent from '../rendered-component/RenderedComponent';\nimport styles from './TopLevelEntry.module.css';\n\nimport { EntityResult } from '../../services/api';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTimes, faShare } from '@fortawesome/free-solid-svg-icons';\nimport { Link } from 'react-router-dom';\n\nexport interface TopLevelEntryProps {\n  id: string;\n  relativePath: string;\n  showOpenButton: boolean;\n  showCloseButton: boolean;\n  rawHtml: string;\n  renderedHtml: string;\n  onViewEntity?: (entity: EntityResult) => void;\n  onEntityClosed?: (id: string) => void;\n}\n\nexport const TopLevelEntry = (props: TopLevelEntryProps) => {\n  const [showRendered, setShowRendered] = useState(true);\n\n  return (\n    <div id={props.id} className={styles.mathlinguaTopLevel}>\n      {props.showCloseButton ? (\n        <button\n          className={styles.mathlinguaCloseButton}\n          onClick={() => {\n            if (props.onEntityClosed) {\n              props.onEntityClosed(props.id);\n            }\n          }}\n          data-test-id=\"close-single-top-level-entry\"\n        >\n          <FontAwesomeIcon icon={faTimes} />\n        </button>\n      ) : null}\n      <span className={styles.mathlinguaIconPane}>\n        {props.showOpenButton ? (\n          <Link\n            to={`/${props.relativePath}#${props.id}`}\n            className={styles.mathlinguaOpenIcon}\n          >\n            <FontAwesomeIcon icon={faShare} />\n          </Link>\n        ) : null}\n        <button\n          className={styles.mathlinguaFlipIcon}\n          onClick={() => {\n            setShowRendered(!showRendered);\n          }}\n        >\n          \n        </button>\n      </span>\n      {showRendered ? (\n        <RenderedComponent\n          onViewEntity={props.onViewEntity}\n          html={props.renderedHtml}\n        />\n      ) : (\n        <RenderedComponent\n          onViewEntity={props.onViewEntity}\n          html={props.rawHtml}\n        />\n      )}\n    </div>\n  );\n};\n","import { useState } from 'react';\nimport { EntityResult } from '../../services/api';\nimport { EntitiesPanel } from '../entities-panel/EntitiesPanel';\nimport { TopLevelEntry } from '../top-level-entry/TopLevelEntry';\nimport styles from './TopLevelEntityGroup.module.css';\nimport * as uuid from 'uuid';\n\nexport interface TopLevelEntityGroupProps {\n  entity: EntityResult;\n  relativePath: string;\n}\n\ninterface EntityResultWithId {\n  id: string;\n  entityResult: EntityResult;\n}\n\nexport const TopLevelEntityGroup = (props: TopLevelEntityGroupProps) => {\n  const [entitiesWithIds, setEntitiesWithIds] = useState(\n    [] as EntityResultWithId[]\n  );\n\n  const onViewEntity = (entity: EntityResult) => {\n    setEntitiesWithIds(\n      entitiesWithIds.concat({\n        id: uuid.v4(),\n        entityResult: entity,\n      })\n    );\n  };\n\n  const onEntityClosed = (id: string) => {\n    setEntitiesWithIds(\n      entitiesWithIds.filter((container) => container.id !== id)\n    );\n  };\n\n  return (\n    <div className={styles.topLevelEntityGroup}>\n      <TopLevelEntry\n        id={props.entity.id}\n        relativePath={props.entity.relativePath}\n        rawHtml={props.entity.rawHtml}\n        renderedHtml={props.entity.renderedHtml}\n        showOpenButton={false}\n        showCloseButton={false}\n        onViewEntity={onViewEntity}\n        onEntityClosed={onEntityClosed}\n      />\n      {entitiesWithIds.length > 0 ? (\n        <div className={styles.triangleBorder}>\n          <div className={styles.triangle}></div>\n        </div>\n      ) : null}\n      <EntitiesPanel\n        entityPanes={entitiesWithIds.map((container) => {\n          return {\n            id: container.id,\n            topLevelEntry: (\n              <div>\n                <TopLevelEntry\n                  id={container.id}\n                  relativePath={container.entityResult.relativePath}\n                  showOpenButton={true}\n                  showCloseButton={true}\n                  rawHtml={container.entityResult.rawHtml}\n                  renderedHtml={container.entityResult.renderedHtml}\n                  onViewEntity={onViewEntity}\n                  onEntityClosed={onEntityClosed}\n                ></TopLevelEntry>\n              </div>\n            ),\n          };\n        })}\n        onCloseAll={() => setEntitiesWithIds([])}\n      />\n    </div>\n  );\n};\n","import Mark from 'mark.js';\nimport { BlockComment } from '../block-comment/BlockComment';\nimport styles from './Page.module.css';\n\nimport * as api from '../../services/api';\nimport { memo, useEffect, useRef, useState } from 'react';\nimport { ErrorView } from '../error-view/ErrorView';\nimport { TopLevelEntityGroup } from '../top-level-entity-group/TopLevelEntityGroup';\nimport { useAppSelector } from '../../support/hooks';\nimport { selectQuery } from '../../store/querySlice';\n\nimport debounce from 'lodash.debounce';\n\nimport AceEditor from 'react-ace';\n\nimport * as langTools from 'ace-builds/src-noconflict/ext-language_tools';\nimport 'ace-builds/src-noconflict/mode-yaml';\nimport 'ace-builds/src-noconflict/theme-eclipse';\nimport { selectIsEditMode } from '../../store/isEditModeSlice';\nimport { isOnMobile } from '../../support/util';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faAngleRight, faAngleLeft } from '@fortawesome/free-solid-svg-icons';\n\ninterface Annotation {\n  row: number;\n  column: number;\n  text: string;\n  type: 'error';\n}\n\ninterface Completion {\n  name: string;\n  value: string;\n}\n\nconst BASE_COMPLETIONS: Completion[] = [\n  { name: 'and', value: 'and:' },\n  { name: 'exists', value: 'exists:\\nsuchThat:' },\n  { name: 'existsUnique', value: 'existsUnique:\\nsuchThat:' },\n  { name: 'forAll', value: 'forAll:\\nsuchThat?:\\nthen:' },\n  { name: 'if', value: 'if:\\nthen:' },\n  { name: 'iff', value: 'iff:\\nthen:' },\n  { name: 'not', value: 'not:' },\n  { name: 'or', value: 'or:' },\n  { name: 'piecewise', value: 'piecewise:' },\n  {\n    name: 'Defines:',\n    value:\n      'Defines:\\nrequiring?:\\nwhen?:\\nmeans:\\nevaluated?:\\nviewing?:\\nusing?:\\nwritten:\\ncalled:\\nMetadata?:',\n  },\n  {\n    name: 'States',\n    value:\n      'States:\\nrequiring?:\\nwhen?:\\nthat:\\nusing?:\\nwritten:\\ncalled:\\nMetadata?:',\n  },\n  { name: 'equality', value: 'equality:\\nbetween:\\nprovided:' },\n  { name: 'membership', value: 'membership:\\nthrough:' },\n  { name: 'as', value: 'as:\\nvia\\nby?:' },\n  { name: 'instance', value: 'instance:\\nof\\nby?:' },\n  {\n    name: 'Resource',\n    value:\n      'Resource:\\n. type?: \"\"\\n. name?: \"\"\\n. author?: \"\"\\n. homepage?: \"\"\\n. url?: \"\"\\n. offset?: \"\"\\nMetadata?:',\n  },\n  {\n    name: 'Axiom',\n    value: 'Axiom:\\ngiven?:\\nif?:\\niff?:\\nthen:\\nusing?:\\nMetadata?:',\n  },\n  {\n    name: 'Conjecture',\n    value: 'Conjecture:\\ngiven?:\\nif?:\\niff?:\\nthen:\\nusing?:\\nMetadata?:',\n  },\n  {\n    name: 'Theorem',\n    value:\n      'Theorem:\\ngiven?:\\nif?:\\niff?:\\nthen:\\nusing?:\\nProof?:\\nMetadata?:',\n  },\n  { name: 'Topic', value: 'Topic:\\ncontent:\\nMetadata?:' },\n  { name: 'Note', value: 'Note:\\ncontent:\\nMetadata?:' },\n];\n\nlet scheduledFunction: { (): void; cancel(): void } | null = null;\n\nexport interface PageProps {\n  viewedPath: string;\n  targetId: string;\n}\n\nexport const Page = (props: PageProps) => {\n  const [fileResult, setFileResult] = useState(\n    undefined as api.FileResult | undefined\n  );\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const isEditMode = useAppSelector(selectIsEditMode);\n\n  useEffect(() => {\n    api.getFileResult(props.viewedPath).then((fileResult) => {\n      if (fileResult) {\n        setFileResult(fileResult);\n      } else {\n        setError('Page Not Found');\n      }\n      setIsLoading(false);\n    });\n  }, [isEditMode, props.viewedPath]);\n\n  if (error) {\n    return (\n      <div className={styles.mathlinguaPage}>\n        <ErrorView message={error} />\n      </div>\n    );\n  }\n\n  if (!fileResult && !isLoading) {\n    return (\n      <div>\n        <ErrorView message=\"Page Not Found\" />\n      </div>\n    );\n  }\n\n  if (\n    !fileResult ||\n    (fileResult.entities.length === 0 && fileResult.errors.length === 0)\n  ) {\n    return null;\n  }\n\n  return isEditMode ? (\n    <SideBySideView\n      relativePath={props.viewedPath}\n      errors={fileResult.errors}\n      entities={fileResult.entities}\n      targetId={props.targetId}\n    ></SideBySideView>\n  ) : (\n    <PageWithNavigationView\n      isOnMobile={isOnMobile()}\n      fileResult={fileResult}\n      targetId={props.targetId}\n    ></PageWithNavigationView>\n  );\n};\n\nconst PageWithNavigationView = (props: {\n  isOnMobile: boolean;\n  fileResult: api.FileResult;\n  targetId: string;\n}) => {\n  return (\n    <div className={styles.mathlinguaPage}>\n      <RenderedContent\n        relativePath={props.fileResult.relativePath}\n        errors={props.fileResult.errors}\n        entities={props.fileResult.entities}\n        targetId={props.targetId}\n      />\n      <div className={styles.linkPanel}>\n        {props.fileResult.previousRelativePath ? (\n          <a\n            className={styles.previousLink}\n            href={`#/${props.fileResult.previousRelativePath}`}\n          >\n            <FontAwesomeIcon icon={faAngleLeft} />\n          </a>\n        ) : null}\n        {props.fileResult.nextRelativePath ? (\n          <a\n            className={styles.nextLink}\n            href={`#/${props.fileResult.nextRelativePath}`}\n          >\n            <FontAwesomeIcon icon={faAngleRight} />\n          </a>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nconst RenderedContent = (props: {\n  relativePath: string;\n  errors: api.ErrorResult[];\n  entities: api.EntityResult[];\n  targetId: string;\n}) => {\n  const query = useAppSelector(selectQuery);\n  const ref = useRef(null);\n\n  useEffect(() => {\n    if (ref.current) {\n      const markInstance = new Mark(ref.current!);\n      markInstance.unmark({\n        done: () => {\n          if (query.length > 0) {\n            markInstance.mark(query, {\n              caseSensitive: false,\n              separateWordSearch: true,\n            });\n          }\n        },\n      });\n    }\n  }, [props.relativePath, props.entities, query]);\n\n  useEffect(() => {\n    if (ref.current) {\n      window.scroll({\n        top: 0,\n        left: 0,\n        behavior: 'auto',\n      });\n      const el = document.getElementById(props.targetId);\n      if (el) {\n        el.scrollIntoView();\n      }\n    }\n  }, [props.targetId, props.relativePath, query]);\n\n  return (\n    <div ref={ref}>\n      <div className={styles.errorView}>\n        {(props.errors || []).map((error) => (\n          <div className={styles.errorItem}>\n            {`ERROR (${error.row + 1}, ${error.column + 1}):`}\n            <pre>{error.message}</pre>\n          </div>\n        ))}\n      </div>\n      {props.entities.map((entityResult) => (\n        <div key={entityResult.id}>\n          {entityResult.type === 'TopLevelBlockComment' ? (\n            <BlockComment\n              renderedHtml={entityResult.renderedHtml}\n              rawHtml={entityResult.rawHtml}\n            />\n          ) : (\n            <TopLevelEntityGroup\n              entity={entityResult}\n              relativePath={props.relativePath}\n            />\n          )}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nconst EditorView = memo(\n  (props: {\n    viewedPath: string;\n    onFileResultChanged(fileResult: api.FileResult | undefined): void;\n  }) => {\n    const aceEditorRef = useRef(null);\n    const [annotations, setAnnotations] = useState([] as Annotation[]);\n\n    useEffect(() => {\n      langTools.setCompleters();\n      langTools.addCompleter({\n        getCompletions: async (\n          editor: any,\n          session: {},\n          pos: { column: number },\n          prefix: string,\n          callback: (n: null, arr: any[]) => void\n        ) => {\n          if (prefix.length === 0) {\n            return callback(null, []);\n          }\n          const column = pos.column;\n          let indent = '\\n';\n          for (let i = 0; i < column - prefix.length; i++) {\n            indent += ' ';\n          }\n          const remoteCompletions = (\n            await api.getSignatureSuffixes(`\\\\${prefix}`)\n          ).map((suffix) => ({\n            name: prefix + suffix,\n            value: prefix + suffix,\n          }));\n          callback(\n            null,\n            BASE_COMPLETIONS.concat(remoteCompletions).map((item) => {\n              return {\n                name: item.name.replace(/\\\\/, ''),\n                value: item.value.replace(/\\\\/, '').replace(/\\n/g, indent),\n              };\n            })\n          );\n        },\n      });\n    }, []);\n\n    useEffect(() => {\n      const editorRefVal = aceEditorRef.current as any;\n      if (editorRefVal) {\n        props.onFileResultChanged({\n          content: '',\n          entities: [],\n          errors: [],\n          relativePath: '',\n        });\n        api.readPage(props.viewedPath).then((content) => {\n          editorRefVal.editor.setValue(content);\n          editorRefVal.editor.clearSelection();\n          editorRefVal.editor.getSession().setAnnotations(annotations);\n        });\n      }\n    }, [props.viewedPath]);\n\n    const saveContent = async (relativePath: string) => {\n      const content = (aceEditorRef.current as any)?.editor?.getValue();\n      if (content) {\n        await api.writeFileResult(relativePath, content);\n        return true;\n      }\n      return false;\n    };\n\n    const onChange = async () => {\n      // only do a save/check after a short pause after the user\n      // has stopped typing\n      if (scheduledFunction) {\n        scheduledFunction.cancel();\n      }\n      scheduledFunction = debounce(async () => {\n        const saved = await saveContent(props.viewedPath);\n        if (saved) {\n          await Promise.all([\n            api.check().then((resp) => {\n              setAnnotations(\n                resp.errors\n                  .filter((err) => err.path === props.viewedPath)\n                  .map((err) => ({\n                    row: Math.max(0, err.row),\n                    column: Math.max(0, err.column),\n                    text: err.message,\n                    type: 'error',\n                  }))\n              );\n            }),\n            api\n              .getFileResult(props.viewedPath)\n              .then((fileResult) => props.onFileResultChanged(fileResult)),\n          ]);\n        }\n      }, 500);\n      scheduledFunction();\n    };\n\n    return (\n      <AceEditor\n        ref={aceEditorRef}\n        mode=\"yaml\"\n        theme=\"eclipse\"\n        onChange={onChange}\n        name=\"ace-editor\"\n        editorProps={{ $blockScrolling: true }}\n        highlightActiveLine={false}\n        showPrintMargin={false}\n        enableBasicAutocompletion={true}\n        enableLiveAutocompletion={false}\n        fontSize=\"90%\"\n        style={{\n          position: 'relative',\n          width: '100%',\n          height: 'calc(100vh - 1.75em)',\n          minHeight: 'calc(100vh - 1.75em)',\n        }}\n        annotations={annotations}\n      ></AceEditor>\n    );\n  }\n);\n\nconst SideBySideView = (props: {\n  relativePath: string;\n  errors: api.ErrorResult[];\n  entities: api.EntityResult[];\n  targetId: string;\n}) => {\n  const [relativePath, setRelativePath] = useState(props.relativePath);\n  const [errors, setErrors] = useState(props.errors);\n  const [entities, setEntities] = useState(props.entities);\n\n  const onFileResultChanged = (result: api.FileResult) => {\n    if (result) {\n      setRelativePath(result.relativePath);\n      setErrors(result.errors);\n      setEntities(result.entities);\n    }\n  };\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'row' }}>\n      <div style={{ width: '50%' }}>\n        <EditorView\n          viewedPath={props.relativePath}\n          onFileResultChanged={onFileResultChanged}\n        />\n      </div>\n      <div\n        style={{\n          width: '50%',\n          maxHeight: 'calc(100vh - 1.75em)',\n          height: 'max-content',\n          overflow: 'scroll',\n          borderLeft: 'solid',\n          borderLeftWidth: '1px',\n          borderLeftColor: '#dddddd',\n          background: '#ffffff',\n        }}\n      >\n        <RenderedContent\n          relativePath={relativePath}\n          errors={errors}\n          entities={entities}\n          targetId={props.targetId}\n        />\n      </div>\n    </div>\n  );\n};\n","import { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport styles from './PathTreeItem.module.css';\n\nimport { sidePanelVisibilityChanged } from '../../store/sidePanelVisibleSlice';\nimport { useAppDispatch, useAppSelector } from '../../support/hooks';\nimport { isOnMobile } from '../../support/util';\nimport { selectIsEditMode } from '../../store/isEditModeSlice';\nimport {\n  errorResultsUpdated,\n  selectErrorResults,\n} from '../../store/errorResultsSlice';\nimport * as api from '../../services/api';\nimport { pathsUpdated } from '../../store/pathsSlice';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faPencilAlt,\n  faTrashAlt,\n  faCheck,\n  faTimes,\n  faFolderPlus,\n  faFileMedical,\n  faCaretRight,\n  faCaretDown,\n} from '@fortawesome/free-solid-svg-icons';\n\nexport interface PathTreeNode {\n  name: string;\n  isDir: boolean;\n  path: string;\n  children: PathTreeNode[];\n}\n\nexport interface PathTreeItemProps {\n  node: PathTreeNode;\n  viewedPath: string;\n}\n\nexport const PathTreeItem = (props: PathTreeItemProps) => {\n  const dispatch = useAppDispatch();\n  const [isExpanded, setIsExpanded] = useState(\n    props.node.isDir && props.node.name === 'content'\n  );\n  const isEditMode = useAppSelector(selectIsEditMode);\n  const allErrorResults = useAppSelector(selectErrorResults);\n  const [inputName, setInputName] = useState('');\n  const [isEditing, setIsEditing] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  const reloadAllPaths = async () => {\n    const allPaths = await api.getAllPaths();\n    dispatch(pathsUpdated(allPaths));\n    const res = await api.check();\n    dispatch(\n      errorResultsUpdated(\n        res.errors.map((err) => ({\n          row: err.row,\n          column: err.column,\n          message: err.message,\n          relativePath: err.path,\n        }))\n      )\n    );\n  };\n\n  const getAllErrorsFor = (\n    node: PathTreeNode,\n    allErrors: api.ErrorResult[]\n  ) => {\n    if (node.isDir) {\n      let result: api.ErrorResult[] = [];\n      for (const child of node.children) {\n        result = result.concat(getAllErrorsFor(child, allErrors));\n      }\n      return result;\n    }\n\n    return allErrorResults.filter((err) => err.relativePath === node.path);\n  };\n\n  const getErrorStats = (allErrorResults: api.ErrorResult[]) => {\n    const thisErrorResults = getAllErrorsFor(props.node, allErrorResults);\n    if (!isEditMode || thisErrorResults.length === 0) {\n      return null;\n    }\n    const title = thisErrorResults.length === 1 ? ' error' : ' errors';\n    return (\n      <span className={styles.errorStats}>\n        {' '}\n        ({thisErrorResults.length} {title})\n      </span>\n    );\n  };\n\n  let name = props.node.name;\n  const index = name.indexOf('_');\n  if (index >= 0) {\n    const prefix = name.substring(0, index);\n    if (prefix.length > 0 && !isNaN(+prefix)) {\n      // the prefix is a number so trim it\n      name = name.substring(index + 1);\n    }\n  }\n  // remove the .math extension and replace underscores with spaces\n  name = name.replace('.math', '').replace(/_/g, ' ');\n\n  const updateInputName = async () => {\n    if (!inputName || (!props.node.isDir && !inputName.endsWith('.math'))) {\n      alert(\n        `The new filename must be non-empty and end in .math but found '${inputName}'`\n      );\n      return;\n    }\n    const newPathParts = props.node.path.split('/');\n    newPathParts.pop(); // pop the end\n    newPathParts.push(inputName); // append the new name\n    const newPath = newPathParts.join('/');\n    if (props.node.isDir) {\n      await api.renameDir(props.node.path, newPath);\n      await reloadAllPaths();\n    } else {\n      await api.renameFile(props.node.path, newPath);\n      await reloadAllPaths();\n    }\n  };\n\n  const onSubmit = (event: any) => {\n    event.preventDefault();\n    updateInputName();\n  };\n\n  const getEditButtons = () => {\n    return isEditMode ? (\n      <span>\n        <button\n          className={styles.button}\n          style={{\n            display:\n              props.node.path !== 'content' && !isEditing && !isDeleting\n                ? 'inline'\n                : 'none',\n          }}\n          onClick={() => {\n            setIsEditing(true);\n            setIsDeleting(false);\n          }}\n        >\n          <FontAwesomeIcon icon={faPencilAlt} />\n        </button>\n        {props.node.isDir && !isEditing && !isDeleting ? (\n          <button\n            className={styles.button}\n            onClick={async () => {\n              const newPath = props.node.path\n                .split('/')\n                .concat('Untitled.math')\n                .join('/');\n              await api.newFile(newPath);\n              setIsExpanded(true);\n              await reloadAllPaths();\n            }}\n          >\n            <FontAwesomeIcon icon={faFileMedical} />\n          </button>\n        ) : null}\n        {props.node.isDir && !isEditing && !isDeleting ? (\n          <button\n            className={styles.button}\n            onClick={async () => {\n              const newPath = props.node.path\n                .split('/')\n                .concat('Untitled')\n                .join('/');\n              await api.newDir(newPath);\n              setIsExpanded(true);\n              await reloadAllPaths();\n            }}\n          >\n            <FontAwesomeIcon icon={faFolderPlus} />\n          </button>\n        ) : null}\n        <button\n          className={styles.button}\n          style={{ display: isEditing || isDeleting ? 'inline' : 'none' }}\n          onClick={async () => {\n            if (isEditing) {\n              await updateInputName();\n            } else {\n              if (props.node.isDir) {\n                await api.deleteDir(props.node.path);\n                await reloadAllPaths();\n              } else {\n                await api.deleteFile(props.node.path);\n                await reloadAllPaths();\n              }\n            }\n            setIsEditing(false);\n            setIsDeleting(false);\n          }}\n        >\n          <FontAwesomeIcon icon={faCheck} />\n        </button>\n        <button\n          className={styles.button}\n          style={{ display: isEditing || isDeleting ? 'inline' : 'none' }}\n          onClick={() => {\n            setIsEditing(false);\n            setIsDeleting(false);\n          }}\n        >\n          <FontAwesomeIcon icon={faTimes} />\n        </button>\n        <button\n          className={styles.button}\n          style={{\n            display:\n              props.node.path !== 'content' && !isEditing && !isDeleting\n                ? 'inline'\n                : 'none',\n          }}\n          onClick={() => {\n            setIsDeleting(true);\n            setIsEditing(false);\n          }}\n        >\n          <FontAwesomeIcon icon={faTrashAlt} />\n        </button>\n      </span>\n    ) : null;\n  };\n\n  if (props.node.isDir) {\n    return (\n      <span\n        className={styles.sidePanelItem}\n        style={{\n          width: isEditMode ? 'max-content' : '100%',\n          maxWidth: isEditMode ? 'max-content' : '100%',\n        }}\n      >\n        <li\n          className={styles.mathlinguaListDirItem}\n          onClick={() => setIsExpanded(!isExpanded)}\n        >\n          {isExpanded ? (\n            <button className={styles.triangle}>\n              <FontAwesomeIcon icon={faCaretDown} />\n            </button>\n          ) : (\n            <button className={styles.triangle}>\n              <FontAwesomeIcon icon={faCaretRight} />\n            </button>\n          )}\n          {isEditing ? (\n            <form onSubmit={onSubmit}>\n              <input\n                className={styles.input}\n                type=\"text\"\n                placeholder={props.node.name}\n                onChange={(event) => setInputName(event.target.value)}\n              ></input>\n              {getEditButtons()}\n            </form>\n          ) : (\n            <span>\n              {name}\n              {getErrorStats(allErrorResults)}\n            </span>\n          )}\n          {!isEditing ? getEditButtons() : null}\n        </li>\n        {isExpanded ? (\n          <ul>\n            {props.node.children.map((child) => (\n              <PathTreeItem\n                key={child.name}\n                node={child}\n                viewedPath={props.viewedPath}\n              />\n            ))}\n          </ul>\n        ) : null}\n      </span>\n    );\n  }\n\n  return (\n    <span\n      className={styles.sidePanelItem}\n      style={{\n        width: isEditMode ? 'max-content' : '100%',\n        maxWidth: isEditMode ? 'max-content' : '100%',\n      }}\n    >\n      <li className={styles.mathlinguaListFileItem}>\n        {isEditing ? (\n          <form onSubmit={onSubmit}>\n            <input\n              className={styles.input}\n              type=\"text\"\n              placeholder={props.node.name}\n              onChange={(event) => setInputName(event.target.value)}\n            ></input>\n            {getEditButtons()}\n          </form>\n        ) : (\n          <Link\n            to={`/${props.node.path}`}\n            key={props.node.name}\n            className={\n              props.viewedPath === props.node.path\n                ? `${styles.link} ${styles.selected}`\n                : styles.link\n            }\n            onClick={() => {\n              if (isOnMobile()) {\n                dispatch(sidePanelVisibilityChanged(false));\n              }\n            }}\n          >\n            {name}\n            {getErrorStats(allErrorResults)}\n          </Link>\n        )}\n        {!isEditing ? getEditButtons() : null}\n      </li>\n    </span>\n  );\n};\n","import styles from './SidePanel.module.css';\n\nimport { useEffect, useState } from 'react';\nimport { pathsUpdated, selectPaths } from '../../store/pathsSlice';\nimport * as api from '../../services/api';\nimport { useAppDispatch, useAppSelector } from '../../support/hooks';\nimport { ErrorView } from '../error-view/ErrorView';\nimport { PathTreeItem, PathTreeNode } from '../path-tree-item/PathTreeItem';\nimport { selectIsEditMode } from '../../store/isEditModeSlice';\n\nexport interface SidePanelProps {\n  viewedPath: string;\n}\n\nexport const SidePanel = (props: SidePanelProps) => {\n  const dispatch = useAppDispatch();\n  const paths = useAppSelector(selectPaths);\n  const isEditMode = useAppSelector(selectIsEditMode);\n\n  const [allPaths, setAllPaths] = useState([] as string[]);\n  const [error, setError] = useState('');\n  const [pathData, setPathData] = useState({\n    name: '',\n    isDir: true,\n    path: '',\n    children: [],\n  } as PathTreeNode);\n\n  useEffect(() => {\n    api\n      .getAllPaths()\n      .then((paths) => {\n        setAllPaths(paths);\n        dispatch(pathsUpdated(paths));\n      })\n      .catch((err) => setError(err.message));\n  }, [dispatch]);\n\n  useEffect(() => {\n    const pathsToView = paths ?? allPaths;\n    setPathData(allPathsToTreeNode(pathsToView));\n  }, [allPaths, paths]);\n\n  const errorView = (\n    <div className={styles.sidePanel}>\n      <ErrorView message={error} />\n    </div>\n  );\n\n  // if in editing mode show the 'content' directory\n  const start = isEditMode ? pathData : pathData.children[0];\n\n  const sidePanel = (\n    <div\n      className={styles.sidePanel}\n      style={\n        isEditMode\n          ? {\n              height: 'calc(100vh - 1.75em)',\n              overflow: 'scroll',\n            }\n          : {}\n      }\n    >\n      {start?.children?.map((node) => (\n        <PathTreeItem\n          key={node.name}\n          node={node}\n          viewedPath={props.viewedPath}\n        />\n      ))}\n    </div>\n  );\n\n  return error ? errorView : sidePanel;\n};\n\nfunction allPathsToTreeNode(allPaths: string[]): PathTreeNode {\n  const root: PathTreeNode = {\n    name: '',\n    isDir: true,\n    path: '',\n    children: [],\n  };\n  for (const path of allPaths) {\n    populateTreeNode(root, path);\n  }\n  return root;\n}\n\nfunction populateTreeNode(root: PathTreeNode, path: string) {\n  const parts = path.split('/');\n  let cur = root;\n  for (let i = 0; i < parts.length; i++) {\n    const p = parts[i];\n    const child = cur.children.find((child) => child.name === p);\n    if (child) {\n      cur = child;\n    } else {\n      const isDir = i !== parts.length - 1;\n      const newChild: PathTreeNode = {\n        name: p,\n        isDir,\n        path: parts.slice(0, i + 1).join('/'),\n        children: [],\n      };\n      cur.children.push(newChild);\n      cur = newChild;\n    }\n  }\n}\n","import { useLocation } from 'react-router';\nimport { Page } from '../page/Page';\nimport { SidePanel } from '../side-panel/SidePanel';\nimport { selectIsEditMode } from '../../store/isEditModeSlice';\nimport { useAppSelector } from '../../support/hooks';\nimport { selectSidePanelVisible } from '../../store/sidePanelVisibleSlice';\nimport { isOnMobile } from '../../support/util';\n\nexport interface HashLocation {\n  viewedPath: string;\n  targetId: string;\n}\n\nfunction getHashLocation(location: {\n  pathname: string;\n  hash: string;\n}): HashLocation {\n  return {\n    viewedPath: location.pathname.replace(/^\\//, ''),\n    targetId: location.hash.replace(/^#/, ''),\n  };\n}\n\nexport const ContentPanel = () => {\n  const hashLocation = getHashLocation(useLocation());\n  const isEditMode = useAppSelector(selectIsEditMode);\n  const isSidePanelVisible = useAppSelector(selectSidePanelVisible);\n  const isMobile = isOnMobile();\n\n  return isEditMode ? (\n    <TwoColumnContent\n      hashLocation={hashLocation}\n      isSidePanelVisible={isSidePanelVisible}\n    ></TwoColumnContent>\n  ) : (\n    <ThreeColumnContent\n      isMobile={isMobile}\n      hashLocation={hashLocation}\n      isSidePanelVisible={isSidePanelVisible}\n    ></ThreeColumnContent>\n  );\n};\n\nconst ThreeColumnContent = (props: {\n  isMobile: boolean;\n  hashLocation: HashLocation;\n  isSidePanelVisible: boolean;\n}) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        padding: 0,\n        margin: 0,\n      }}\n    >\n      <div\n        style={{\n          display:\n            !props.isMobile || props.isSidePanelVisible ? 'block' : 'none',\n          width: props.isMobile ? '100%' : '20%',\n          padding: 0,\n          margin: 0,\n        }}\n      >\n        {props.isSidePanelVisible ? (\n          <SidePanel viewedPath={props.hashLocation.viewedPath} />\n        ) : null}\n      </div>\n      <div\n        style={{\n          width: props.isMobile\n            ? props.isSidePanelVisible\n              ? '0%'\n              : '95%'\n            : '60%',\n          marginTop: '1em',\n        }}\n      >\n        <Page\n          viewedPath={props.hashLocation.viewedPath}\n          targetId={props.hashLocation.targetId}\n        />\n      </div>\n      <div\n        style={{\n          width: props.isMobile ? '0%' : '20%',\n          display: props.isMobile ? 'none' : 'block',\n        }}\n      ></div>\n    </div>\n  );\n};\n\nconst TwoColumnContent = (props: {\n  hashLocation: HashLocation;\n  isSidePanelVisible: boolean;\n}) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        padding: '0',\n        margin: '0',\n      }}\n    >\n      <div style={{ width: props.isSidePanelVisible ? '20%' : '0' }}>\n        {props.isSidePanelVisible ? (\n          <SidePanel viewedPath={props.hashLocation.viewedPath} />\n        ) : null}\n      </div>\n      <div\n        style={{\n          width: props.isSidePanelVisible ? '80%' : '100%',\n          border: 'solid',\n          borderColor: '#cccccc',\n          borderWidth: '1px',\n          marginTop: '0.5em',\n        }}\n      >\n        <Page\n          viewedPath={props.hashLocation.viewedPath}\n          targetId={props.hashLocation.targetId}\n        />\n      </div>\n    </div>\n  );\n};\n","import styles from './App.module.css';\n\nimport React from 'react';\nimport { TopBar } from './components/topbar/TopBar';\n\nimport { HashRouter, Switch, Route } from 'react-router-dom';\nimport { ContentPanel } from './components/content-panel/ContentPanel';\n\nexport const App = () => {\n  return (\n    <HashRouter hashType=\"slash\">\n      <ErrorBoundary>\n        <div className={styles.contentPanel}>\n          <TopBar />\n          <Switch>\n            <Route path=\"/:relativePath(.*)\" children={<ContentPanel />} />\n          </Switch>\n        </div>\n      </ErrorBoundary>\n    </HashRouter>\n  );\n};\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n}\n\nclass ErrorBoundary extends React.Component<{}, ErrorBoundaryState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      hasError: false,\n    };\n  }\n\n  componentDidCatch(error: any, info: any) {\n    this.setState({\n      hasError: true,\n    });\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <p>\n          An error occurred connecting to the MathLingua server. Are you running{' '}\n          <code>mlg serve</code>?\n        </p>\n      );\n    } else {\n      return this.props.children;\n    }\n  }\n}\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\n\nimport thunkMiddleware from 'redux-thunk';\n\nimport pathsReducer from './pathsSlice';\nimport sidePanelVisibleReducer from './sidePanelVisibleSlice';\nimport queryReducer from './querySlice';\nimport isEditModeReducer from './isEditModeSlice';\nimport errorResultsReducer from './errorResultsSlice';\n\nexport const store = configureStore({\n  reducer: {\n    sidePanelVisible: sidePanelVisibleReducer,\n    paths: pathsReducer,\n    query: queryReducer,\n    isEditMode: isEditModeReducer,\n    errorResults: errorResultsReducer,\n  },\n  middleware: [thunkMiddleware],\n});\n\nexport type AppDispatch = typeof store.dispatch;\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './App';\nimport { store } from './store/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './support/serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchArea\":\"SearchPanel_searchArea__3eH01\",\"search\":\"SearchPanel_search__2HQuA\",\"searchDropdown\":\"SearchPanel_searchDropdown__24NWE\",\"searchDropdownItem\":\"SearchPanel_searchDropdownItem__3wg4x\",\"searchDropdownItemSelected\":\"SearchPanel_searchDropdownItemSelected__20Nxq\",\"searchButton\":\"SearchPanel_searchButton__2WliP\",\"clearButton\":\"SearchPanel_clearButton___bhw7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mathlinguaPage\":\"Page_mathlinguaPage__316SN\",\"errorView\":\"Page_errorView__1w9pu\",\"errorItem\":\"Page_errorItem__2mYLP\",\"linkPanel\":\"Page_linkPanel__1lmJv\",\"previousLink\":\"Page_previousLink__pU3BI\",\"nextLink\":\"Page_nextLink__3hVie\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mathlinguaTopLevel\":\"TopLevelEntry_mathlinguaTopLevel__tOe0D\",\"mathlinguaIconPane\":\"TopLevelEntry_mathlinguaIconPane__2KBDK\",\"mathlinguaFlipIcon\":\"TopLevelEntry_mathlinguaFlipIcon__-3nJ2\",\"mathlinguaOpenIcon\":\"TopLevelEntry_mathlinguaOpenIcon__8Id1v\",\"mathlinguaCloseButton\":\"TopLevelEntry_mathlinguaCloseButton__o8PUx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"entitiesPanel\":\"EntitiesPanel_entitiesPanel__1Sx74\",\"entitiesPanelItem\":\"EntitiesPanel_entitiesPanelItem__1Xi0s\",\"closeAllButton\":\"EntitiesPanel_closeAllButton__1uj94\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"topLevelEntityGroup\":\"TopLevelEntityGroup_topLevelEntityGroup__MMFuW\",\"triangle\":\"TopLevelEntityGroup_triangle__7AIJb\",\"triangleBorder\":\"TopLevelEntityGroup_triangleBorder__2sXGm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"errorLabel\":\"ErrorView_errorLabel__2AXEh\",\"errorMessage\":\"ErrorView_errorMessage__2gtow\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sidePanel\":\"SidePanel_sidePanel__2wshc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"contentPanel\":\"App_contentPanel__1ZGS7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"topbar\":\"TopBar_topbar__2sxmu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sidePanelButton\":\"SidePanelButton_sidePanelButton__u4HAg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"githubIcon\":\"GitHubIcon_githubIcon__20bvO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"editModeButton\":\"EditModeButton_editModeButton__1Orbv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mathlinguaBlockCommentTopLevel\":\"BlockComment_mathlinguaBlockCommentTopLevel__dhGBJ\"};"],"sourceRoot":""}